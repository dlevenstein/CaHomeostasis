

%dA = -kf.*A + kd(1-A);
A = kf./(kf+fd);
Ca = Ca0 + (R_mini+R_spk).*Ca_PSP.*A;

kf = kf_0 + k_CamK.*Sigmoid(Ca,(Ca_alpha.*(1-beta)+Ca_beta.*beta),k_CamK);
kd = kd_0 + k_CaN.*Sigmoid(Ca,Ca_CaN,k_CaN);
beta = Sigmoid(Ca,Ca_beta,k_beta);


%% Parameters
kf_0 = 1;       %CamKII-independent (i.e. baseline) phosphorylation rate
kd_0 = 1;       %CaN-independent (i.e. baseline) dephosphorylation rate
k_CamK = 1;     %Maximal CamKII-mediated phoshorpylation rate
k_CaN = 1;      %Maximal CaN-mediated dephosphorylation rate

Ca_0 = 0;       %GluA1-independent (i.e. baseline) Calcium concentration    
Ca_PSP = 1;     %Calcium from 1Hz PSPs with GluA1 fully phosphorylated
Ca_alpha = 0.1; %Ca midpoint for CamKII alpha
Ca_beta = 0.5;  %Ca midpoint for CamKII beta
Ca_CaN = 0.5;   %Ca midpoint for CaN
Ca_beta = 0.5;  %Ca midpoint for CamKII alpha-beta transition

k_CamK = 10;    %Steepness of CamKII activation
k_CaN = 4;      %Steepness of CaN activation
k_beta 



Ca_X = linspace(0,10,100);

